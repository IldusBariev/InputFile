@using System.Net.Http
@using System.Net
@using System.Text.Json
@using System.Net.Http.Json
@using BlazorApp2.Response
@page "/"

<div class="news-container">
    <div class="news-block">
        НОВОСТИ
        @* <img class="news-desktop" src="/NEWS/NEWS_kollage.png"> *@
        @* <img class="news-list" src="/NEWS/1.png"> *@
        @* <img class="news-list" src="/NEWS/2.png"> *@
        @* <img class="news-list" src="/NEWS/3.png"> *@
        @* <img class="news-list" src="/NEWS/4.png"> *@
        @* <img class="news-list" src="/NEWS/5.png"> *@
        @* <img class="news-list" src="/NEWS/6.png"> *@
        @* <img class="news-list" src="/NEWS/7.png"> *@
        @* <img class="news-list" src="/NEWS/8.png"> *@

        <p>@Message</p>

        @foreach (var item in getAllNews)
        {
            <div class="news-view-container">
                <div class="news-main-views">



                    <div class="news-view-block">


                        @if (item.Image != null)
                        {
                            <div class="news-image-container">
                                <img src="@item.Image">
                            </div>
                        }
                        <div class="news-main-container">

                            <h3>@item.Title</h3>

                            <p>@item.Description</p>

                        </div>

                    </div>

                </div>
            </div>
        }

    </div>
</div>


@code {

    [Inject] private HttpClient HttpClient { get; set; }

    private string? Message;

    // Список всех новостей новостей
    // GetAllNews состоит из Айди, Заголовка, Описания и ссылки к изображению
    private List<GetAllNews>? getAllNews;

    protected override async Task OnInitializedAsync()
    {
        try
        {
            getAllNews = await HttpClient.GetFromJsonAsync<List<GetAllNews>>("CreateNews");
        }

        catch (HttpRequestException e)
        {
            Message = $"HTTP Error: {e.Message}";
        }

        catch (JsonException e) {
            Message = $"Ошибка десериализации JSON: {e.Message}";
        }

        catch (Exception e)
        {
            Message = $"Error: {e.Message}";
        }

    }

}
